<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MSL (Maharashtra Seamless) Pipes – Quotation Calculator | Vijay Sales Corporation</title>

<style>
  :root{ --brand:#24364e; }
  body{font-family:Arial,Helvetica,sans-serif;background:#f7f8fb;color:#333;margin:0}
  header{background:var(--brand);color:#fff;padding:10px 14px;text-align:center;font-weight:700}
  main{max-width:980px;margin:24px auto;padding:0 16px}
  h1{color:var(--brand);margin:6px 0 14px}

  .card{background:#fff;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.06);padding:16px;margin:14px 0;width:100%;display:block}
  label{display:block;margin:10px 0 6px;font-weight:600}
  select,input{width:100%;padding:10px;border:1px solid #ccd1d9;border-radius:6px;background:#fff;min-height:44px}

  .row{display:grid;gap:12px}
  @media (min-width:720px){ .row.cols-4{grid-template-columns:1fr 1fr 1fr 1fr} }

  .btn{background:var(--brand);color:#fff;border:none;border-radius:8px;padding:10px 16px;font-weight:700;cursor:pointer}
  .btn.secondary{background:#fff;color:var(--brand);border:2px solid var(--brand)}

  table{width:100%;border-collapse:collapse;margin-top:10px}
  #quoteTable{width:100%;table-layout:auto;min-width:900px}
  th,td{border:1px solid #e3e6eb;padding:10px;text-align:center}
  th{background:var(--brand);color:#fff}
  tfoot td{font-weight:700}

  .flex{display:flex;gap:10px;flex-wrap:wrap}
  .right{justify-content:flex-end}
  .divider{border:0;border-top:1px solid #e3e6eb;margin:16px 0}
  .powered-by{display:block;width:100%;text-align:center;margin:16px 0 0;color:#555;font-size:14px}

  /* Mobile-friendly table cards */
  @media (max-width:640px){
    main{padding:0 12px}
    h1{font-size:clamp(20px,5.5vw,26px)}
    th,td{padding:8px 6px;font-size:13px}

    #quoteTable{min-width:0;border-collapse:separate;border-spacing:0 12px}
    #quoteTable thead{display:none}
    #quoteTable tbody tr{
      display:grid;grid-template-columns:1fr 1fr;gap:8px;background:#fff;
      border:1px solid #e3e6eb;border-radius:8px;padding:12px;
    }
    #quoteTable tbody td{border:none;padding:0;text-align:left;background:#fff;font-size:14px}
    #quoteTable tbody td:nth-child(1)::before{content:"Product: ";font-weight:700;color:#667085;display:block}
    #quoteTable tbody td:nth-child(2)::before{content:"OD (mm): ";font-weight:700;color:#667085;display:block}
    #quoteTable tbody td:nth-child(3)::before{content:"Type: ";font-weight:700;color:#667085;display:block}
    #quoteTable tbody td:nth-child(4)::before{content:"Unit (INR/m): ";font-weight:700;color:#667085;display:block}
    #quoteTable tbody td:nth-child(5)::before{content:"Pipes: ";font-weight:700;color:#667085;display:block}
    #quoteTable tbody td:nth-child(6)::before{content:"Metres: ";font-weight:700;color:#667085;display:block}
    #quoteTable tbody td:nth-child(7)::before{content:"Line Total (INR): ";font-weight:700;color:#667085;display:block}
    #quoteTable tbody td:nth-child(8)::before{content:"Remove: ";font-weight:700;color:#667085;display:block}
    #quoteTable tbody td:nth-child(8){grid-column:1 / -1;justify-self:end}

    #quoteTable tfoot tr{
      display:grid;grid-template-columns:1fr auto;gap:8px;background:#fff;
      border:1px solid #e3e6eb;border-radius:8px;padding:12px;
    }
    #quoteTable tfoot td{border:none;padding:0;text-align:left}
    .row{grid-template-columns:1fr !important}
    .card .flex.right{justify-content:stretch;flex-direction:column}
    .card .flex.right .btn{width:100%}
  }
</style>

<!-- jsPDF + AutoTable -->
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.4/dist/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
<header>Vijay Sales Corporation • sales@vijaysalescorp.com • +91 9999889008</header>

<main>
  <h1>MSL Seamless Pipes – Price & Quotation Calculator</h1>

  <div class="card">
    <div class="row cols-4">
      <div>
        <label for="category">Product</label>
        <select id="category">
          <option value="MSL Seamless (per metre)">MSL Seamless (per metre)</option>
        </select>
      </div>
      <div>
        <label for="size">OD (mm)</label>
        <select id="size"></select>
      </div>
      <div>
        <label for="ptype">Type (Schedule / Thickness)</label>
        <select id="ptype"></select>
      </div>
      <div>
        <label for="pipes">Number of Pipes</label>
        <input type="number" id="pipes" value="1" min="1" />
      </div>

      <div>
        <label for="unitPrice">List Price (INR / metre)</label>
        <input type="text" id="unitPrice" readonly />
      </div>
      <div>
        <label for="discount">Discount (%)</label>
        <input type="number" id="discount" value="48" readonly />
      </div>
      <div>
        <label>&nbsp;</label>
        <button class="btn" onclick="addItem()">Add to Quotation</button>
      </div>
    </div>
    <p class="muted" style="margin:8px 0 0;color:#666;font-size:12px;">
      Note: 1 pipe = <strong>6 metres</strong>. Prices are per metre before discount. Source: MSL price list (14-Jul-2025). :contentReference[oaicite:1]{index=1}
    </p>
  </div>

  <div class="card">
    <h2 style="margin:0 0 10px">Quotation Summary</h2>
    <div class="table-responsive">
      <table id="quoteTable">
        <thead>
          <tr>
            <th>Product</th>
            <th>OD (mm)</th>
            <th>Type</th>
            <th>Unit (INR/m)</th>
            <th>Pipes</th>
            <th>Metres</th>
            <th>Line Total (INR)</th>
            <th>Remove</th>
          </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
          <tr>
            <td colspan="6" style="text-align:right">Sub-Total</td>
            <td id="subTotal">INR 0</td><td></td>
          </tr>
          <tr>
            <td colspan="6" style="text-align:right">GST (18%)</td>
            <td id="gstAmt">INR 0</td><td></td>
          </tr>
          <tr>
            <td colspan="6" style="text-align:right"><strong>Grand Total</strong></td>
            <td id="grandTotal">INR 0</td><td></td>
          </tr>
        </tfoot>
      </table>
    </div>

    <hr class="divider" />

    <div class="flex right">
      <button class="btn" onclick="downloadPDF()">Download PDF</button>
      <button class="btn secondary" onclick="sendWA()">Send via WhatsApp</button>
      <button class="btn secondary" onclick="resetAll()">Reset</button>
    </div>
  </div>

  <p class="powered-by">⚡ Powered by <strong>Vijay Sales Corporation</strong> – India’s Piping Experts since 1961.</p>
</main>

<script>
/* ========= PRICE DATA (INR per metre) =========
   From "MAHARASHTRA SEAMLESS LTD. PRICE LIST 14.07.25". Only schedule/thickness allowed for the chosen OD appear.
   (You can paste in more rows as needed; structure is size -> {type: price}).
*/
const MSL_DATA = {
  "21.30": {"½” SCH.40":449, "½” SCH.80":573, "½” SCH.160":690},
  "26.70": {"¾” SCH.40":598, "¾” SCH.80":778, "¾” SCH.160":1026},
  "33.40": {"1” SCH.40":581, "1” SCH.80":753, "1” SCH.160":1114},
  "42.20": {"1¼” SCH.40":719, "1¼” SCH.80":1039, "1¼” SCH.160":1417},
  "48.30": {"1½” SCH.40":818, "1½” SCH.80":1093, "1½” SCH.160":1538},
  "60.30": {"2” SCH.40":1000, "2” SCH.80":1376, "2” SCH.160":2268},

  "73.00": {"2½” SCH.40":1570, "2½” SCH.80":2075, "2½” SCH.160":3015},
  "88.90": {"3” SCH.40":2053, "3” SCH.80":2777, "3” SCH.160":4314},
  "101.60": {"3½” SCH.40":2687, "3½” SCH.80":3691},
  "114.30": {"4” SCH.40":2925, "4” SCH.80":4059, "4” SCH.120":5494, "4” SCH.160":6778},

  "141.30": {"5” SCH.40":3959, "5” SCH.80":6008, "5” SCH.120":8140},
  "168.30": {"6” SCH.40":5140, "6” SCH.80":7741, "6” SCH.120":10517, "6” SCH.160":13655, "6” SCH.XXS":16489},
  "219.10": {
    "8” SCH.20":7407, "8” SCH.30":7441, "8” SCH.40":8341, "8” SCH.60":10621, "8” SCH.80":13193,
    "8” SCH.100":16109, "8” SCH.120":19190, "8” SCH.140":21416, "8” SCH.160":23610
  },

  "273.00": {
    "10” SCH.20":9283, "10” SCH.30":10308, "10” SCH.40":11818, "10” SCH.60":16311, "10” SCH.80":19590,
    "10” SCH.100":24340, "10” SCH.120":28223, "10” SCH.140/XXS":32910, "10” SCH.160":36554
  },
  "323.80": {
    "12” SCH.20":10548, "12” SCH.30":13437, "12” STD":15224, "12” SCH.40":16591, "12” XS":21660,
    "12” SCH.60":24214, "12” SCH.80":29354, "12” SCH.100":35538, "12” SCH.120/XXS":41551,
    "12” SCH.140":46254, "12” SCH.160":53059, "12” SCH. NS 36":59379, "12” SCH. NS 40":65062
  },

  "355.60": {
    "14” SCH.20":14821, "14” SCH.30/STD":18079, "14” SCH.40":21018, "14” XS":23874, "14” SCH.60":28169,
    "14” SCH.80":35147, "14” SCH.100":43342, "14” SCH.120":49940, "14” SCH.140":56369,
    "14” NS 35.01":61624, "14” SCH.160":62624
  },
  "406.40": {"16” SCH.30/STD":22618, "16” SCH.40/XS":29903, "16” SCH.80":49358},

  "457.00": {"18” STD":27629, "18” XS":36558, "18” SCH.40":40933},
  "508.00": {"20” SCH.20/STD":30776, "20” SCH.30/XS":40754, "20” SCH.40":48189}
};
/* ========= UI ========= */
const $size  = document.getElementById('size');
const $ptype = document.getElementById('ptype');
const $pipes = document.getElementById('pipes');
const $unit  = document.getElementById('unitPrice');
const $disc  = document.getElementById('discount');
const $tbody = document.querySelector('#quoteTable tbody');
const $sub   = document.getElementById('subTotal');
const $gst   = document.getElementById('gstAmt');
const $grand = document.getElementById('grandTotal');

let rows = [];

/* Init sizes */
(function init(){
  Object.keys(MSL_DATA)
    .sort((a,b)=>parseFloat(a)-parseFloat(b))
    .forEach(mm=>{
      const o = document.createElement('option'); o.value=mm; o.textContent=mm; $size.appendChild(o);
    });
  onSizeChange();
})();
$size.addEventListener('change', onSizeChange);
$ptype.addEventListener('change', updateUnit);

function onSizeChange(){
  $ptype.innerHTML = '';
  const map = MSL_DATA[$size.value] || {};
  Object.keys(map).forEach(t=>{
    const o = document.createElement('option'); o.value=t; o.textContent=t; $ptype.appendChild(o);
  });
  updateUnit();
}

function updateUnit(){
  const perM = (MSL_DATA[$size.value]||{})[$ptype.value];
  $unit.value = perM ? perM.toLocaleString('en-IN') : '';
}

function addItem(){
  const size = $size.value;
  const type = $ptype.value;
  const perM = (MSL_DATA[size]||{})[type];
  if(!perM) return alert('Please select a valid OD & Type.');
  const pipes = Math.max(1, parseInt($pipes.value||'1',10));
  const metres = pipes * 6;
  const discountPct = parseFloat($disc.value)||0;

  const netPerM = perM * (1 - discountPct/100);
  const total = netPerM * metres;

  rows.push({size,type,perM,discountPct,pipes,metres,total});
  $pipes.value = 1;
  renderRows();
}

function renderRows(){
  $tbody.innerHTML = '';
  rows.forEach((r,i)=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>MSL Seamless (per metre)</td>
      <td>${r.size}</td>
      <td>${r.type}</td>
      <td>INR ${(r.perM*(1-r.discountPct/100)).toLocaleString('en-IN',{maximumFractionDigits:2})}</td>
      <td>${r.pipes}</td>
      <td>${r.metres}</td>
      <td>INR ${r.total.toLocaleString('en-IN',{maximumFractionDigits:2})}</td>
      <td><button class="btn secondary" onclick="removeRow(${i})">X</button></td>
    `;
    $tbody.appendChild(tr);
  });
  recalc();
}
function removeRow(i){ rows.splice(i,1); renderRows(); }

function recalc(){
  const sub = rows.reduce((a,b)=>a+b.total,0);
  const gst = +(sub*0.18).toFixed(2);
  const grand = sub + gst;
  $sub.textContent   = "INR " + sub.toLocaleString('en-IN',{maximumFractionDigits:2});
  $gst.textContent   = "INR " + gst.toLocaleString('en-IN',{maximumFractionDigits:2});
  $grand.textContent = "INR " + grand.toLocaleString('en-IN',{maximumFractionDigits:2});
}

function resetAll(){ rows=[]; renderRows(); recalc(); }

/* ========= PDF ========= (uses "INR" to avoid missing ₹ glyph) */
function downloadPDF(){
  recalc();
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  doc.setFontSize(14);
  doc.text('MSL Seamless Pipes – Quotation', 14, 14);
  doc.setFontSize(10);
  doc.text('Vijay Sales Corporation • sales@vijaysalescorp.com • +91 9999889008',14,20);

  const body = rows.length ? rows.map(r=>[
    'MSL Seamless', r.size, r.type,
    `INR ${(r.perM*(1-r.discountPct/100)).toLocaleString('en-IN',{maximumFractionDigits:2})}`,
    r.pipes, r.metres,
    `INR ${r.total.toLocaleString('en-IN',{maximumFractionDigits:2})}`
  ]) : [['-','-','-','-','-','-','-']];

  doc.autoTable({
    startY: 26,
    head: [['Product','OD (mm)','Type','Unit (INR/m)','Pipes','Metres','Line Total (INR)']],
    body
  });

  const y = (doc.lastAutoTable?.finalY || 26) + 8;
  const sub = rows.reduce((a,b)=>a+b.total, 0);
  const gst = +(sub * 0.18).toFixed(2);
  const grand = sub + gst;

  doc.setFontSize(11);
  doc.text(`Sub-Total: INR ${sub.toLocaleString('en-IN',{maximumFractionDigits:2})}`, 14, y);
  doc.text(`GST (18%): INR ${gst.toLocaleString('en-IN',{maximumFractionDigits:2})}`, 14, y+6);
  doc.setFont(undefined,'bold');
  doc.text(`Grand Total: INR ${grand.toLocaleString('en-IN',{maximumFractionDigits:2})}`, 14, y+14);
  doc.setFont(undefined,'normal');
  doc.setFontSize(9);
  doc.text('Notes: Rates are EX Delhi; Freight extra as per actual. GST @ 18% extra. Price list at dispatch applies. 1 pipe = 6 metres. Discount 48%.', 14, y+22);

  doc.save('MSL-Seamless-Pipes-Quotation.pdf');
}

/* ========= WhatsApp ========= */
function sendWA(){
  recalc();
  let msg = 'MSL Seamless Pipes Quotation – Vijay Sales Corporation\n\n';
  if(!rows.length){ msg += '(No items added)\n'; }
  rows.forEach(r=>{
    msg += `• OD ${r.size} mm | ${r.type} | Pipes ${r.pipes} | Metres ${r.metres} | Unit INR ${(r.perM*(1-r.discountPct/100)).toLocaleString('en-IN',{maximumFractionDigits:2})} | Line INR ${r.total.toLocaleString('en-IN',{maximumFractionDigits:2})}\n`;
  });
  const sub = rows.reduce((a,b)=>a+b.total,0);
  const gst = +(sub*0.18).toFixed(2);
  const grand = sub + gst;
  msg += `\nSub-Total: INR ${sub.toLocaleString('en-IN',{maximumFractionDigits:2})}`;
  msg += `\nGST (18%): INR ${gst.toLocaleString('en-IN',{maximumFractionDigits:2})}`;
  msg += `\nGrand Total: INR ${grand.toLocaleString('en-IN',{maximumFractionDigits:2})}\n\n`;
  msg += `Contact: 9999889008 • sales@vijaysalescorp.com`;

  const url = `https://wa.me/919999889008?text=${encodeURIComponent(msg)}`;
  window.open(url,'_blank');
}
</script>
</body>
</html>
